# Introdução ao Hacking e Pentest

Estas são as anotações das partes práticas do curso [Introdução ao Hacking e Pentest](https://solyd.com.br/ead/course/introducao-ao-hacking-e-pentest/) oferecido pela Solyd. Todos os passos são executados no site desenvolvido exclusivamente para isso: http://www.bancocn.com.

## Exploração

Nesta etapa o mais importante que temos a descobrir é:
- Se usarmos <code>'</code> como id no URL, recebemos um erro de sintaxe do SQL, então podemos tentar explorar vulnerabilidades do SQL;
- Pelo arquivo /robots.txt, descobrimos a existência da página /admin.

## SQL Injection

Vamos descobrir quantas colunas tem usando o comando SQL ORDER BY Keyword, ele é usado para ordenar os resultados em ordem ascendente ou descendente de acordo com os valores de determinada coluna.
Então por exemplo se queremos ordenar o resultado o resultado pelos valores da coluna 1 e comentar o que viria depois do código usando --, então vamos passar <code>1 ORDER BY 1--</code>. Vamos inserir os comandos sempre após <code>www.bancocn.com/cat.php?id=</code>.
<pre> 
1 ORDER BY 1-- :ok
1 ORDER BY 2-- :ok
1 ORDER BY 3-- :ok
1 ORDER BY 4-- : Unknown column '4' in 'order clause'
</pre>

Então agora sabemos que temos 3 colunas. O comando UNION é usado para combinar o resultados de múltiplos SELECTS, então vamos adicionar uma linha ao resultado.  Vai ser adicionado no final do resultado, mas ele lê o primeiro resultado, então vamos usar o sinal negativo para inverter a ordem dos resultados, por exemplo: <code>-1 UNION SELECT 1,2,3</code>. Podemos usar então database() para obtermos o nome do banco de dados onde as informações são exibidas na tela: 

<code>-1 UNION SELECT 1,2,database()</code>.

Com isso sabemos o nome do nosso banco de dados: bancocn. Para sabermos todas tabelas do banco de dados podemos usar: 

<code>-1 UNION SELECT 1,2, GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema="bancocn"</code>

Basicamente, estamos inserindo uma linha onde as duas primeiras colunas são 1 e 2 respectivamente, e o terceiro que é o que será exibido na tela, então concatenamos o resultado, que é a busca na tabela tables no banco de dados information_schema que pertence ao banco de dados bancocn, de acordo com o valor na coluna table_schema.

Obtemos agora os nomes das tabelas do nosso banco de dados: categories,pictures,stats,users. Então com os nomes das tabelas escolhemos ver melhor a tabela users, usando um código parecido:

<code>-1 UNION SELECT 1,2, GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_schema="bancocn" AND table_name="users"</code>

As colunas são: id,login,password. Então agora olhamos a tabela das colunas e olhamos onde o banco de dados é bancocn e a tabela é users.

Então podemos agora simplesmente exibir, o login senha:
<code>-1 UNION SELECT 1,2, login FROM bancocn.users</code>
<code>-1 UNION SELECT 1,2, password FROM bancocn.users</code>

Obtemos então o usuário (admin) e a senha (7b71be0e85318117d2e514ce2a2e222c).

Testamos uma criptografia padrão (MD5), usando o [MD5 Decrypter](https://www.md5online.org/) desciptografamos a senha: senhafoda e conseguimos acesso ao painel de admin descoberto anteriormente.

## Shell reversa

Olhando a estrutura dos endereços das imagens carregadas, podemos acessar o diretório dos arquivos /admin/uploads. Lá podemos então abrir um arquivo com extensão php que enviemos ao servidor.

Vamos carregar um arquivo PHP que recebe comandos e executa no terminal. 